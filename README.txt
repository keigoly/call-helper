==============================================================
BlueBean 音声ガイダンスアプリ セットアップガイド
==============================================================

このアプリは、BlueBean で電話を受けたときに
自動で音声ガイダンスを相手に流すためのものです。

ガイダンスが流れている間は、お互いの声が聞こえない状態になり、
ガイダンスが終わると、普通に会話できるようになります。


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
はじめに確認すること
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

このアプリを使うには、以下の2つのソフトが必要です。
ステップ1・ステップ2 でインストール方法を説明します。

  (1) VB-Audio Virtual Cable （仮想オーディオケーブル）
  (2) VoiceMeeter           （音声ミキサー）


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ステップ 1：VB-Audio Virtual Cable をインストールする
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  1. 配布フォルダの中にある「VBCABLE_Driver_Pack45.zip」を
     デスクトップなどに展開（解凍）してください。

  2. 展開したフォルダの中にある「VBCABLE_Setup_x64.exe」を
     【右クリック】→【管理者として実行】してください。

  3. 画面の指示に従い「Install Driver」をクリックしてください。

  4. 「インストールが完了しました」と表示されたら、
     パソコンを再起動してください。

  ※ 再起動しないと正しく認識されないことがあります。


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ステップ 2：VoiceMeeter をインストールする
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  1. 配布フォルダの中にある「VoicemeeterSetup_v2122.zip」を
     デスクトップなどに展開（解凍）してください。

  2. 展開したフォルダの中にある「VoicemeeterSetup.exe」を
     ダブルクリックして実行してください。

  3. 画面の指示に従い、インストールを完了してください。

  4. インストールが終わったら、パソコンを再起動してください。


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ステップ 3：VoiceMeeter の設定をする
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  VoiceMeeter は、マイクの音声とガイダンスの音声を
  まとめて BlueBean に送るために使います。

  1. スタートメニューから「VoiceMeeter」を起動してください。

  2. 画面の左側に「HARDWARE INPUT 1」という欄があります。
     ここをクリックして、普段使っているマイクを選んでください。

  3. その右隣に「HARDWARE INPUT 2」という欄があります。
     ここをクリックして、一覧の中から
     「WDM: CABLE Output (VB-Audio Virtual Cable)」を選んでください。

  4. HARDWARE INPUT 1 と HARDWARE INPUT 2 の両方で、
     「B1」と書かれたボタンをクリックして、点灯させてください。
     （点灯 = 有効、消灯 = 無効です）

  5. VoiceMeeter の画面右上にある「Menu」をクリックし、
     「System Tray (Run at Startup)」にチェックを入れてください。
     これで、パソコン起動時に VoiceMeeter が自動で立ち上がります。

  ※ VoiceMeeter は常に起動しておく必要があります。
     閉じてしまうとガイダンスが相手に届かなくなります。


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ステップ 4：アプリの配置
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  1. 配布フォルダの中にある以下の3つのファイルを、
     パソコンの分かりやすい場所にまとめて置いてください。

     - call_helper.exe  （アプリ本体）
     - config.ini       （設定ファイル）
     - guidance.mp3     （ガイダンス音声）

     おすすめの場所：
       C:\BlueBean\call_helper\

  2. 3つのファイルは必ず同じフォルダに置いてください。
     バラバラの場所に置くと動きません。

  ※ config.ini は通常そのまま変更不要です。
     ガイダンス音声を差し替えたい場合は、新しい音声ファイルを
     「guidance.mp3」という名前にして、同じフォルダに上書きしてください。


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ステップ 5：BlueBean のマイク設定を変更する
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  BlueBean が使うマイクを VoiceMeeter 経由に変更します。

  1. BlueBean の画面右上にある歯車アイコン（設定）を
     クリックしてください。

  2. 「その他設定」タブを開いてください。

  3. 「マイク」の欄を「VoiceMeeter Output (VB-Audio VoiceMeeter VAIO)」
     に変更してください。

  4. 設定を保存してください。

  ※ この設定は一度やれば OK です。
     ガイダンスを使わないときも、そのままで問題ありません。


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
ステップ 6：BlueBean にコマンドを登録する
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  電話を受けたときに自動でガイダンスが流れるように、
  BlueBean にコマンドを登録します。

  1. BlueBean の設定画面から「コマンド連携設定」タブを
     開いてください。

  2. 「応答時アクセス」の欄に、以下のようにコマンドを入力します。

     C:\BlueBean\call_helper\call_helper.exe --mode=incoming --number=

     ※「C:\BlueBean\call_helper\」の部分は、ステップ4 で
       ファイルを置いた場所に合わせて変えてください。

  3. --number= の後ろにカーソルを置いた状態で、
     画面にある「相手番号」ボタンをクリックしてください。
     自動で番号のパラメータが入力されます。

  4. 設定を保存してください。

  ※ 「着信時アクセス」に登録すると、電話が鳴った瞬間
    （受話前）にガイダンスが流れます。
     通常は「応答時アクセス」をおすすめします。


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
設定完了！ 動作の確認
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  以上でセットアップは完了です。
  テスト電話をかけて、以下の動作を確認してください。

  [1] 電話を受ける
       ↓
  [2] 自動でガイダンスが相手に流れる
      （この間、お互いの声は聞こえません）
       ↓
  [3] ガイダンスが終わると「ピー」と鳴る
       ↓
  [4] 普通に会話できるようになる

  うまくいかない場合は、下の「困ったときは」を確認してください。


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
困ったときは
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  ● ガイダンスが流れない
    → VoiceMeeter が起動しているか確認してください。
      画面右下のタスクトレイ（時計の近く）にアイコンがあれば起動中です。
    → config.ini と guidance.mp3 が call_helper.exe と
      同じフォルダにあるか確認してください。

  ● 相手にガイダンスが聞こえない
    → VoiceMeeter の設定を確認してください（ステップ3）。
      HARDWARE INPUT 2 が「WDM: CABLE Output」になっているか、
      B1 ボタンが点灯しているか確認してください。
    → BlueBean のマイク設定が「VoiceMeeter Output」に
      なっているか確認してください（ステップ5）。

  ● ガイダンス後にマイクが使えない（声が届かない）
    → Windows 画面右下のスピーカーアイコンを右クリックし、
      「音量ミキサーを開く」からマイクのミュートを手動で
      解除してください。

  ● ガイダンス後にスピーカーから音が出ない
    → Windows 画面右下のスピーカーアイコンをクリックし、
      ミュートになっていれば解除してください。

  ● ログを確認したい
    → call_helper.exe と同じフォルダに「call_helper.log」
      というファイルが作られます。
      メモ帳で開くと、動作の記録を確認できます。


━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
補足：ガイダンス音声を変更したい場合
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

  1. 新しい音声ファイルを MP3 形式で用意してください。

  2. ファイル名を「guidance.mp3」に変更してください。

  3. call_helper.exe と同じフォルダに上書きコピーしてください。

  ※ ファイル名は必ず「guidance.mp3」にしてください。
     別の名前だと認識されません。


以上
